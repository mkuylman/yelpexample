"use strict";var main=window.main||{};main.mapShareKey="map-shares",main.ga=window.ga||function(){},main=function(e){return((window.gitter={}).chat={}).options={disableDefaultChat:!0},e.chat={},e.chat.isOpen=!1,e.chat.createHelpChat=function(){throw new Error("Sidecar chat has not initialized")},document.addEventListener("gitter-sidecar-ready",function(a){e.chat.GitterChat=a.detail.Chat,e.chat.createHelpChat=function(a,t,n){n=a.replace(/([A-Z])/g," $1").replace("Java Script","JavaScript"),$("body").append('<aside id="chat-embed-help" class="gitter-chat-embed is-collapsed" />'),e.chat.helpChat=new e.chat.GitterChat({room:"freecodecamp/"+a,activationElement:!1,targetElement:$("#chat-embed-help")}),$(t).on("click",function(){var a=!$(this).hasClass("active");e.chat.helpChat.toggleChat(a),a&&$(t).addClass("active")});var i=!1;$("#chat-embed-help").on("gitter-chat-toggle",function(e){var a=!!e.originalEvent.detail.state;return i||(i=!0,$("#chat-embed-help > .gitter-chat-embed-action-bar").prepend('<div class="chat-embed-main-title"><span>'+n+"</span></div>")),a?$(t).addClass("active"):$(t).removeClass("active")})},$("body").append('<aside id="chat-embed-main" class="gitter-chat-embed is-collapsed" />'),e.chat.mainChat=new e.chat.GitterChat({room:"freecodecamp/freecodecamp",activationElement:!1,targetElement:$("#chat-embed-main")});var t=!1;$("#chat-embed-main").on("gitter-chat-toggle",function(){return t?null:(t=!0,void $("#chat-embed-main > .gitter-chat-embed-action-bar").prepend('<div class="chat-embed-main-title"><span>Free Code Camp\'s Main Chat</span></div>'))}),$("#nav-chat-btn").on("click",function(){e.chat.isOpen||e.chat.mainChat.toggleChat(!0)})}),e}(main);var lastCompleted="undefined"!=typeof lastCompleted?lastCompleted:"";main.getMapShares=function(){var e=JSON.parse(localStorage.getItem(main.mapShareKey)||"[]");return e&&Array.isArray(e)||(localStorage.setItem(main.mapShareKey,JSON.stringify([])),e=[]),e},main.setMapShare=function(e){var a=main.getMapShares(),t=!1;return a.forEach(function(a){a===e&&(t=!0)}),t||a.push(e),localStorage.setItem(main.mapShareKey,JSON.stringify(a)),a},$(document).ready(function(){function e(a){a.preventDefault();for(var t=this,n=t.id,i=$(t).data().upVotes,o="undefined"!=typeof o?o:"",r=!1,s=0;s<i.length;s++)if(i[s].upVotedBy===o){r=!0;break}r||$.post("/stories/upvote",{id:n}).fail(function(){$(t).bind("click",e)}).done(function(e){$(t).text("Upvoted!").addClass("disabled"),$("#storyRank").text(e.rank+" points")})}var a="X-CSRF-Token",t=function(e){jQuery.ajaxPrefilter(function(t,n,i){i.crossDomain||i.setRequestHeader(a,e)})};t($('meta[name="csrf-token"]').attr("content")),$("img").error(function(){$(this).unbind("error").attr("src","https://s3.amazonaws.com/freecodecamp/camper-image-placeholder.png")}),$("#story-list").on("click","button.btn-upvote",e);var n=function l(){if(!$("#story-submission-form")[0].checkValidity())return null;var e=$("#story-url").val(),a=$("#story-title").val(),t=$("#description-box").val(),n={data:{link:e,headline:a,timePosted:Date.now(),description:t,storyMetaDescription:main.storyMetaDescription,rank:1,image:main.storyImage}};$("#story-submit").unbind("click"),$.post("/stories/",n).fail(function(){$("#story-submit").bind("click",l)}).done(function(e){var a=e.storyLink,t=e.isBanned;return t?(window.location="/news",null):void(window.location="/stories/"+a)})};$("#story-submit").on("click",n);var i=main.getMapShares();lastCompleted&&-1===i.indexOf(lastCompleted)&&$('div[id="'+lastCompleted+'"]').parent().parent().removeClass("hidden"),$(".map-challenge-block-share").on("click",function(e){e.preventDefault();var a=$(this).children().attr("id"),t=a.replace(/\s/,"%20"),n="undefined"!=typeof window.username?window.username:"",i="https://www.facebook.com/dialog/feed?app_id=1644598365767721&display=page&caption=I%20just%20completed%20the%20"+t+"%20section%20on%20Free%20Code%20Camp%2E&link=http%3A%2F%2Ffreecodecamp%2Ecom%2F"+n+"&redirect_uri=http%3A%2F%2Ffreecodecamp%2Ecom%2Fmap";main.setMapShare(a),window.ga("send","event","FB_LINK","SHARE","Facebook map share"),window.location.href=i});var o,r,s=localStorage.getItem("currentDashedName"),c=$("p.padded-ionic-icon a");!s&&$(".sr-only").length&&(c=$(".sr-only")),r=c.filter(function(){return s?$(this).attr("href").match(s):" Complete"===$(this).text()}),r.length&&(r=r[r.length-1],o=$(r).offset().top-380,$("html, body, .map-accordion").scrollTop(o)),String(window.location).match(/\/map$/gi)&&$(".text-center").css("top","50px"),$("#nav-map-btn").on("click",function(){if(!main.isMapAsideLoad){var e=$("<iframe>");e.attr("src","/map-aside"),$(".map-aside").append(e),main.isMapAsideLoad=!0}$(".map-aside").removeClass("is-collapsed")}),$(".map-aside-action-collapse").on("click",function(){$(".map-aside").addClass("is-collapsed")}),$("#accordion").on("show.bs.collapse",function(e){$(e.target).prev().find(".fa-caret-right").removeClass("fa-caret-right").addClass("fa-caret-down"),$("a[data-toggle=collapse]").length===$(".fa-caret-down").length&&($("#showAll").text("Collapse all challenges"),$("#showAll").addClass("active"))}).on("hide.bs.collapse",function(e){$(e.target).prev().find(".fa-caret-down").removeClass("fa-caret-down").addClass("fa-caret-right"),$("a[data-toggle=collapse]").length===$(".fa-caret-right").length&&($("#showAll").text("Expand all challenges"),$("#showAll").removeClass("active"))}),$("#showAll").on("click",function(){var e=$("#showAll").hasClass("active");return e?($.each($(".map-collapse.in"),function(e,a){$(a).css("height","100%"),$(a).removeClass("in"),$(a).prev().find(".fa-caret-down").removeClass("fa-caret-down").addClass("fa-caret-right")}),$("#showAll").text("Expand all challenges"),$("#showAll").removeClass("active")):($.each($('.map-collapse:not(".in")'),function(e,a){$(a).css("height","100%"),$(a).addClass("in"),$(a).prev().find(".fa-caret-right").removeClass("fa-caret-right").addClass("fa-caret-down")}),$("#showAll").text("Collapse all challenges"),$("#showAll").addClass("active"))})});